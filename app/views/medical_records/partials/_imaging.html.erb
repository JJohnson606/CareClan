<!-- app/views/medical_records/partials/_imaging.html.erb -->
<div class="imaging-record">
  <h4>Imaging Details</h4>
  <% notes = JSON.parse(medical_record.notes) rescue nil %>
  <% if notes %>
    <p><strong>Type:</strong> <%= notes['type'] %></p>
    <p><strong>Findings:</strong> <%= notes['findings'] %></p>
    <p><strong>Interpretation:</strong> <%= notes['interpretation'] %></p>
    <% if medical_record.images.attached? %>
      <h5>Associated Images:</h5>
      <div class="image-gallery">
        <% medical_record.images.each do |image| %>
          <%= image_tag image.variant(resize_to_limit: [300, 300]) %>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <p>Invalid or missing imaging data.</p>
  <% end %>
</div>
